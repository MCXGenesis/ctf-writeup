# Jinja Ninja

> WTF is a JINJA? Aint it supposed to be NINJA RAHHHHHHHH

## The challenge

Given instance that contains a link to a website. This is what the homepage looks like.

![](images/Pasted%20image.png)

## How to solve

This website functionality is to return (or to greet) what is typed on the textbox. So if I write MCXGenesis ...

![](images/Pasted%20image%20(2).png)

But the highligh is on the description of the below ...

```
How it works

This web app greets you using your inputâ€¦ but beware: the ninja hides power in its template engine.

Can you craft the right input to make the ninja reveal the secret flag hidden at /flag?
```

The description of how it works provides a useful tip. Thus, I searched on browser with keywords such as 'jinja ninja' and 'exploit'. I found an interesting [Medium article by Hacking-Lab](https://medium.com/@hacking-lab/rce-web-application-vulnerability-jinja-template-injection-751f8e08c496) and a few articles regarding that topic.

In summary, jinja templates have a vulnerability of a server side injection that allows Remote Command Execution (RCE).

The payload that i use is

```
{{ config.__class__.__init__.__globals__['os'].popen('cat /flag').read() }}
```

Let's submit the form with the payload

![](images/Pasted%20image%20(3).png)

## The flag
```
HCS{n0w_y0u_h4v3_l34rn3d_ab0ut_SST1_thr0ugh_th1s_ch4ll3ng3_c0ngratzzzzzz_n1nj4_w4r10r_1675c3d7-ec09-4280-be45-4fc0cb0df285}
```